{"version":3,"file":"src_app_pages_login_login_module_ts.js","mappings":"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","sources":["./src/app/pages/login/login-routing.module.ts","./src/app/pages/login/login.module.ts","./src/app/pages/login/login.page.ts","./src/guards/auth.guard.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { LoginPage } from './login.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: LoginPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class LoginPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { LoginPageRoutingModule } from './login-routing.module';\r\n\r\nimport { LoginPage } from './login.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    LoginPageRoutingModule\r\n  ],\r\n  declarations: [LoginPage]\r\n})\r\nexport class LoginPageModule {}\r\n","\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { Storage } from '@ionic/storage-angular';\r\nimport { Router } from '@angular/router';\r\n\r\nimport { AuthGuard } from '../../../guards/auth.guard';\r\nimport { User } from '../../interfaces/user';\r\nimport { Session } from '../../interfaces/session';\r\n\r\n@Component({\r\n  selector: 'app-login',\r\n  templateUrl: './login.page.html',\r\n  styleUrls: ['./login.page.scss'],\r\n})\r\nexport class LoginPage implements OnInit {\r\n\r\n  registrado: User=null;\r\n\r\n  user: User={\r\n    id: '',\r\n    username:'',\r\n    password:'',\r\n    email:'',\r\n    type:''\r\n  };\r\n\r\n  opennedSesion: Session=null;\r\n\r\n  sesion: Session={\r\n    type:'session',\r\n    name:'',\r\n    id:''\r\n  };\r\n\r\n  constructor(private storage: Storage, private router: Router  ) { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  onSubmit()\r\n  {\r\n    console.log(this.user);\r\n    this.logear();\r\n  }\r\n\r\n  async deleteElement(element) {\r\n    await this.storage.remove(element);\r\n  }\r\n\r\n  async logear()\r\n  {\r\n    this.registrado = await this.storage.get(this.user.username);\r\n    if (this.registrado!=null)\r\n    {\r\n      this.sesion.name = this.user.username;\r\n      this.sesion.id = this.registrado.id;\r\n      this.opennedSesion = await this.storage.get(this.sesion.type);\r\n      if (this.opennedSesion == null) {\r\n        // creamos una sesion\r\n        await this.storage.set(this.sesion.type, this.sesion);\r\n      } else {\r\n        this.storage.forEach(element => {\r\n          if (element.type === 'session') {\r\n            this.deleteElement(element);\r\n          }\r\n        });\r\n        await this.storage.set(this.sesion.type, this.sesion);\r\n      }\r\n      if(this.user.username === this.registrado.username && this.user.password === this.registrado.password)\r\n      {\r\n        // abrir pagina estudiante\r\n        AuthGuard.itsCorrect = true;\r\n        this.router.navigate(['/homestudent']);\r\n      }\r\n      else{\r\n        console.log('Usuario no existe!!!');\r\n      }\r\n    }\r\n    else{\r\n      console.log('Pa la casa por agilao');\r\n    }\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { ActivatedRouteSnapshot, CanActivate, RouterStateSnapshot, UrlTree } from '@angular/router';\r\nimport { Observable } from 'rxjs';\r\nimport { Router } from '@angular/router';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class AuthGuard implements CanActivate {\r\n\r\n  // aqui comprobamos el inicio de sesion\r\n  static itsCorrect = false;\r\n  static username = '';\r\n\r\n  constructor( private router:Router  ) { }\r\n\r\n  // esta funcion nos retornara un valor dependiendo de si es o no correcto\r\n  autorizar() {\r\n    if (AuthGuard.itsCorrect == true){\r\n      return true;\r\n    } else {\r\n      return false;\r\n      this.router.navigate(['/login']);\r\n    }\r\n  }\r\n\r\n  canActivate(\r\n    route: ActivatedRouteSnapshot,\r\n    state: RouterStateSnapshot): Observable<boolean | UrlTree> | Promise<boolean | UrlTree> | boolean | UrlTree {\r\n    return this.autorizar();\r\n  }\r\n}\r\n"],"names":[],"sourceRoot":"webpack:///","x_google_ignoreList":[]}